# Содержание

+ [Общие требования](#ch1p1)
    + [Именование переменных](#ch1p1s1)
    + [Форматирование текста программы](#ch1p1s2)
    + [Написание комментария](#ch1p1s3)

## <a name="ch1p1"></a> Общие требования. ##
### <a name="ch1p1s1"></a> Именование переменных  ###
1. Имена переменных составляются из слов английского языка (транслитерация русских слов не допускается).
2. Имена неконстантных переменных, классов, методов, структур состоят из строчных символов (допускается использовать отдельные слова из прописных символов), слова разделятся символом подчеркивания «_».
3. Имена констант, перечислений, элементов перечислений состоят только из прописных символов, для разделения слов используется символ подчеркивания «_».
4. Глобальные переменные начинаются с префикса «g_» («G_» - для глобальных констант).
### <a name="ch1p1s2"></a> Форматирование текста программы ###
1. Длина строки равна 80 символам. Если строка программного кода не помещается целиком, она разбивается на несколько строк.
2. Абзацный отступ – 4 пробела.
3. В строке располагается только один оператор.
4. Фигурная скобка в системных выражениях располагается на одном уровне с кодом. Пример: 
```C++
system_word (…)
    {
    // Какой-то код.
    } 
```
5. Используются фигурные скобки, даже если в условном операторе имеется одна строка. Пример:
```C++
if( something() )
 {
 somethig_else();
 }
```
### <a name="ch1p1s3"></a> Написание комментария ###
1. Комментарии должны быть написаны/описаны/оформлены предложениями на русском языке, они должны быть хорошо составлены и иметь правильную пунктуацию, по возможности без сокращений.
2. Пробел — один из наиболее эффективных комментариев. Пример:
```C++
 if ( par != 0 &&
 step_duration_par_n[ mode ][ step_n ] != 0 &&
 MyGetMS() - steps[ mode ][ step_n ].get_start_time() >
 par->getParam( step_duration_par_n[ mode ][ step_n ] ) *
2L )
 {
 return 1;
 }
```
3. Комментарий пишется в стиле системы документирования [Doxygen](https://www.doxygen.nl/).
4. В начале каждого заголовочного модуля (*.h) следует служебная информация, содержащая сведения об авторе (основной разработчик, занимающийся поддержкой данного модуля), назначении файла, директивах препроцессора(может быть опущено при отсутствии таковых), последней версии (поля автоматически заполняются системой контроля версий Subversion). Формат:
```C++
/// @file modeMngr.h
/// @brief Краткое описание.
///
/// Подробное описание.
///
/// @author Иванюк Дмитрий Сергеевич.
///
/// @par Описание директив препроцессора:
/// @c PAC - компиляция для контроллера.@n
/// @c WIN - компиляция для Windows.
///
/// @par Текущая версия:
/// @$Rev$.@n
/// @$Author$.@n
/// @$Date:: $.
```
5. Каждое определение функции (объявление класса, структуры) отделяется специальным комментарием (80 символов). Это подобно заголовкам разделов. Вид:
```C++
//------------------------------------------------------------------------------
```
6. Комментирование объявления класса (структуры) осуществляется в следующем виде:
```C++
//------------------------------------------------------------------------------
/// @brief Краткое описание назначения класса (структуры).
///
/// Подробное описание.
class step_path
 {
 };
```
7. Комментирование определения функций осуществляется в следующем виде:
```C++
//------------------------------------------------------------------------------
void descriptive_name( type descriptive_name )
 {
 // Здесь помещается комментарий, описывающий, как
 // функция делает то, что она делает. Он может пропускаться
 // если программа сама по себе достаточно содержательна.
 code_goes_here();
 }
```
8. Каждое определение функций нового класса отделяется специальным комментарием. Вид:
```C++
//------------------------------------------------------------------------------
//------------------------------------------------------------------------------
```
9. Комментирование объявления методов (функций) осуществляется в следующем виде:
```C++
/// @brief Устанока количества открываемых\закрываемых устройств.
///
/// @param new_close_dev_cnt - число закрываемых устройств.
/// @param new_open_dev_cnt - число открываемых устройств.
///
/// @return < 0 - ошибка.
/// @return 0 - Ок.
int set_dev_cnt( u_int_2 new_close_dev_cnt,
 u_int_2 new_open_dev_cnt );
```
10. Комментирование объявления членов классов осуществляется в следующем виде:
```C++
/// @brief Количество закрываемых устройств.
 /// @details Это свойство определяет размер буфера, в котором
 /// хранятся указатели на закрываемые устройства.
 u_int_2 close_devices_cnt;
 /// @brief Количество открываемых устройств.
 /// @details Это свойство определяет размер буфера, в котором
 /// хранятся указатели на открываемые устройства.
 u_int_2 open_devices_cnt;
 /// @brief Номер последнего добавленного устройства.
 u_int_2 last_close_dev;
 /// @brief Номер последнего добавленного устройства.
 u_int_2 last_open_dev;
 TVDO **closeDevices; ///< Закрываемые устройства.
 TVDO **openDevices; ///< Открываемые устройства.

 u_int_4 start_time; ///< Время старта шага.
 char in_x; ///< Координата x начала маршрута.
 char in_y; ///< Координата y начала маршрута.
 char out_x; ///< Координата x конца маршрута.
 char out_y; ///< Координата y конца маршрута.
 ```
11. Комментирование кода должно быть в виде блоков. Пример:
 ```C++
// Вот блочный комментарий, описывающий последующий блок
// программы. После общего резюме описываются некоторые
// особенности:
// 1. Этот комментарий описывает, что происходит в строке
// с меткой 1.
// 2. Этот комментарий описывает, что происходит в строке
// с меткой 2.
//
// Или используется следующий комментарий:
// Алгоритм устанавливается на начальное значение [1]. Затем
// делается...[2], после чего проверяется...[3].
//
here_is_the_code();
while( some_condition )
 {
 this_code_is_rather_obscure(); // 1
 }
more_stuff_here();
while( some_condition )
 {
 this_code_is_also_obscure(); // 2
 }
 ```
12. Должно использоваться табличное форматирование кода. Пример:
```C++
int x; // Описание что делает x.
unsigned long int ( *pfi )(); // Описание что делает pfi.
int z; // Описание что делает z.
const char *the_variable; // Описание the_variable.
x = 10; // Здесь идет комментарий.
the_variable = x; // Здесь второй комментарий.
z = x; // A здесь третий.
```
13. Длинный список инициализации элементов форматируется следующим образом:
```C++
class derived : public base
 {
 string str;
 const int x;
 public:
 derived( char *init_str, int init_x );
 }
derived::derived( char *init_str, int init_x ): base( str, x
),
 str( init_str ),
 x( init_x )
 {
 }
```
14. Так как директива препроцессора #ifdef почти всегда расположена на некотором расстоянии от #endif, то всегда комментируется #endif. Пример:
```C++
#ifndef SOMEFILE_H
#define SOMEFILE_H
// Здесь следует 1000 строк программы.
#endif // SOMEFILE_H
```
